## 缺陷检测解决策略之五:特征提取+分类器训练之训练区域提取

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/7d882b1c07014260bc0366a068601aaa.png)

```cpp
***
*
* 一 训练区域提取
*
***

if(0)    
    * 原始数据 - 路径
    rawData_Directory := 'MLP_粗糙度小批量精确数据集/rawData/直边'
    * 提取的训练区域数据 - 路径
    trainData_Directory := 'MLP_粗糙度小批量精确数据集/trainData/直边'
    * 区域类别
    RegionType:='Line'
else
    * 原始数据 - 路径
    rawData_Directory := 'MLP_粗糙度小批量精确数据集/rawData/R角'
    * 提取的训练区域数据 - 路径
    trainData_Directory := 'MLP_粗糙度小批量精确数据集/trainData/R角'
    * 区域类别
    RegionType:='R' 
endif

* 设置窗体绘画模式
dev_set_draw ('margin')
* 遍历得到所有目录路径Files（A\B\C\D\E）
list_files (rawData_Directory, 'directories', Files)
* 获取目录长度
tuple_length (Files, Length)  
* 遍历目录
for i := 0 to Length-1 by 1  
    * 分割路径
    tuple_split (Files[i], '\\', Substrings)     
    * 获取分割后的长度
    tuple_length (Substrings, SubstringsLen)
    * 获取最后一个字符串(这里分割没有意义，只是为了取出最后一个目录明)
    tuple_split (Substrings[SubstringsLen-1], 'W', FileName)
    * 遍历单个目录Files[i]下所有的图像文件ImageFiles
    list_image_files (Files[i], 'default', [], ImageFiles)    
    * 获取单个类别目录下的文件数量
    tuple_length (ImageFiles, Length1)
    * 遍历单个类别目录下的所有图像文件
    for Index := 0 to Length1-1 by 1   
        * 分割图像文件路径
        tuple_split (ImageFiles[Index], '/', Substrings) 
        * 分割后长度
        tuple_length (Substrings, SubstringsLen)
        * 分割文件名
        tuple_split (Substrings[SubstringsLen-1], '.', Substrings1)     
        * 去尾缀，获得纯粹的文件名
        ImageName:=Substrings1[0]
        * 读取图像
        read_image (Image, ImageFiles[Index])      
        ******训练区域************************************************************

        GenTrainRegion (Image, TrainRegion, trainData_Directory, FileName, ImageName,RegionType)
        
        ******检测区域************************************************************
*          GenDetectionRegion (Image, DectionRegion, DectionContour, RegionType)
        
    endfor
endfor

dev_get_window (WindowHandle)
set_tposition (WindowHandle, 24, 12)
set_display_font (WindowHandle, 30, 'mono', 'true', 'false')
write_string (WindowHandle, '生成数据结束')
 












```

